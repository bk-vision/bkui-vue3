!function(e,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n(require("../shared"),require("vue"),require("../virtual-render"),require("vue-types"),require("../exception"),require("../checkbox"),require("../icon"));else if("function"==typeof define&&define.amd)define(["../shared","vue","../virtual-render","vue-types","../exception","../checkbox","../icon"],n);else{var t="object"==typeof exports?n(require("../shared"),require("vue"),require("../virtual-render"),require("vue-types"),require("../exception"),require("../checkbox"),require("../icon")):n(e["../shared"],e.vue,e["../virtual-render"],e["vue-types"],e["../exception"],e["../checkbox"],e["../icon"]);for(var r in t)("object"==typeof exports?exports:e)[r]=t[r]}}(self,((e,n,t,r,o,i,a)=>(()=>{var l={8022:(e,n,t)=>{var r=t(4481),o=t(6426),i=o;i.v1=r,i.v4=o,e.exports=i},8725:e=>{for(var n=[],t=0;t<256;++t)n[t]=(t+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")}},9157:e=>{var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var t=new Uint8Array(16);e.exports=function(){return n(t),t}}else{var r=new Array(16);e.exports=function(){for(var e,n=0;n<16;n++)0==(3&n)&&(e=4294967296*Math.random()),r[n]=e>>>((3&n)<<3)&255;return r}}},4481:(e,n,t)=>{var r,o,i=t(9157),a=t(8725),l=0,u=0;e.exports=function(e,n,t){var c=n&&t||0,s=n||[],d=(e=e||{}).node||r,f=void 0!==e.clockseq?e.clockseq:o;if(null==d||null==f){var p=i();null==d&&(d=r=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==f&&(f=o=16383&(p[6]<<8|p[7]))}var v=void 0!==e.msecs?e.msecs:(new Date).getTime(),y=void 0!==e.nsecs?e.nsecs:u+1,N=v-l+(y-u)/1e4;if(N<0&&void 0===e.clockseq&&(f=f+1&16383),(N<0||v>l)&&void 0===e.nsecs&&(y=0),y>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=v,u=y,o=f;var _=(1e4*(268435455&(v+=122192928e5))+y)%4294967296;s[c++]=_>>>24&255,s[c++]=_>>>16&255,s[c++]=_>>>8&255,s[c++]=255&_;var h=v/4294967296*1e4&268435455;s[c++]=h>>>8&255,s[c++]=255&h,s[c++]=h>>>24&15|16,s[c++]=h>>>16&255,s[c++]=f>>>8|128,s[c++]=255&f;for(var I=0;I<6;++I)s[c+I]=d[I];return n||a(s)}},6426:(e,n,t)=>{var r=t(9157),o=t(8725);e.exports=function(e,n,t){var i=n&&t||0;"string"==typeof e&&(n="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,n)for(var l=0;l<16;++l)n[i+l]=a[l];return n||o(a)}},5800:e=>{"use strict";e.exports=i},9911:e=>{"use strict";e.exports=o},6870:e=>{"use strict";e.exports=a},4212:n=>{"use strict";n.exports=e},3511:e=>{"use strict";e.exports=t},748:e=>{"use strict";e.exports=n},210:e=>{"use strict";e.exports=r}},u={};function c(e){var n=u[e];if(void 0!==n)return n.exports;var t=u[e]={exports:{}};return l[e](t,t.exports,c),t.exports}c.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return c.d(n,{a:n}),n},c.d=(e,n)=>{for(var t in n)c.o(n,t)&&!c.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},c.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{"use strict";c.r(s),c.d(s,{default:()=>X});var e,n,t,r=c(4212),o=c(748),i=c(3511),a=c.n(i);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}!function(e){e.NODE_CLICK="nodeClick",e.NODE_COLLAPSE="nodeCollapse",e.NODE_EXPAND="nodeExpand",e.NODE_CHECKED="nodeChecked",e.NODE_DRAG_START="nodeDragStart",e.NODE_DRAG_OVER="nodeDragOver",e.NODE_DRAG_LEAVE="nodeDragLeave",e.NODE_DROP="nodeDrop"}(t||(t={}));var u,d=function(){return!0},f=(l(e={},t.NODE_CLICK,d),l(e,t.NODE_COLLAPSE,d),l(e,t.NODE_EXPAND,d),l(e,t.NODE_CHECKED,d),l(e,t.NODE_DRAG_START,d),l(e,t.NODE_DRAG_OVER,d),l(e,t.NODE_DRAG_LEAVE,d),l(e,t.NODE_DROP,d),e);!function(e){e.DEPTH="__depth",e.INDEX="__index",e.UUID="__uuid",e.PARENT_ID="__parent_id",e.HAS_CHILD="__has_child",e.PATH="__path",e.IS_ROOT="__is_root",e.ORDER="__order",e.IS_OPEN="__is_open",e.IS_CHECKED="__is_checked",e.IS_SELECTED="__is_selected",e.IS_ASYNC_INIT="__is_async_init",e.IS_MATCH="__is_match",e.IS_NULL="__IS_NULL",e.IS_CACHED="__is_cached",e.IS_ASYNC="__is_async",e.IS_LOADING="__is_loading",e.TREE_NODE_ATTR="__attr__"}(u||(u={}));var p,v=(l(n={},u.IS_OPEN,"isOpen"),l(n,u.IS_SELECTED,"selected"),l(n,u.IS_MATCH,"isMatch"),l(n,u.HAS_CHILD,"hasChild"),l(n,u.IS_CHECKED,"checked"),l(n,u.IS_ASYNC,"async"),l(n,u.IS_LOADING,"loading"),l(n,u.IS_ROOT,"isRoot"),n);!function(e){e.CLICK="click",e.SELECTED="selected",e.EXPAND="expand",e.COLLAPSE="collapse"}(p||(p={}));var y,N,_,h=c(210);!function(e){e.ONCE="once",e.EVERY="every"}(y||(y={})),function(e){e.FUZZY="fuzzy",e.FULL="full"}(N||(N={})),function(e){e.TREE="tree",e.LIST="list"}(_||(_={}));var I={data:r.PropTypes.arrayOf(r.PropTypes.any).def([]),label:r.PropTypes.oneOfType([r.PropTypes.func.def(void 0),r.PropTypes.string.def("label")]),nodeKey:r.PropTypes.string.def(void 0),children:r.PropTypes.string.def("children"),indent:r.PropTypes.number.def(18),lineHeight:r.PropTypes.number.def(32),levelLine:r.PropTypes.oneOfType([r.PropTypes.bool.def(!1),r.PropTypes.func.def(void 0),r.PropTypes.string.def("1px dashed #c3cdd7")]).def(!1),virtualRender:r.PropTypes.bool.def(!1),prefixIcon:r.PropTypes.oneOfType([r.PropTypes.func.def((function(){})),r.PropTypes.bool.def(!1)]).def(!0),async:r.PropTypes.shape({callback:r.PropTypes.func.def(void 0),cache:r.PropTypes.bool.def(!0),deepAutoOpen:(0,h.toType)("columnType",{}).def(y.ONCE)}),offsetLeft:r.PropTypes.number.def(5),search:r.PropTypes.oneOfType([r.PropTypes.shape({value:r.PropTypes.oneOfType([r.PropTypes.number,r.PropTypes.string,r.PropTypes.bool]).def(""),match:r.PropTypes.oneOfType([(0,h.toType)("TreeSearchMatchType",{}).def(N.FUZZY),r.PropTypes.func]),resultType:(0,h.toType)("treeSearchResultType",{}).def(_.TREE),openResultNode:r.PropTypes.bool}),r.PropTypes.string,r.PropTypes.number,r.PropTypes.bool]).def(void 0),emptyText:r.PropTypes.string.def("没有数据"),draggable:r.PropTypes.bool.def(!1),disableDrag:r.PropTypes.func,disableDrop:r.PropTypes.func,dragSort:r.PropTypes.bool.def(!1),selectable:r.PropTypes.oneOfType([r.PropTypes.bool,r.PropTypes.func]).def(!0),disabledFolderSelectable:r.PropTypes.bool.def(!1),showCheckbox:r.PropTypes.bool.def(!1),showNodeTypeIcon:r.PropTypes.bool.def(!0),selected:r.PropTypes.oneOfType([r.PropTypes.string,r.PropTypes.number,r.PropTypes.object]),autoCheckChildren:r.PropTypes.bool.def(!0),autoOpenParentNode:r.PropTypes.bool.def(!0),expandAll:r.PropTypes.bool.def(!1),nodeContentAction:r.PropTypes.oneOfType([r.PropTypes.arrayOf((0,h.toType)("nodeContentActionType",{}).def(p.CLICK)),r.PropTypes.func.def((function(){return["selected"]}))]).def(["selected","expand","click"])},E=c(9911),S=c.n(E);function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}var g=c(5800),T=c.n(g),A=c(6870);const C=function(e,n){var t=function(n){return e.schema.get(n)},r=function(e,n){var r;return null===(r=t(e[u.UUID]))||void 0===r?void 0:r[n]},o=function(n,r,o){e.schema.set(n[u.UUID],Object.assign(Object.assign({},t(n[u.UUID])),l({},r,o)))},i=function(e){return r(e,u.PATH)},a=function(e){return r(e,u.UUID)},c=function(e){return r(e,u.IS_ROOT)},s=function(e){return r(e,u.IS_OPEN)},d=function(e){return r(e,u.HAS_CHILD)},f=function(e){return r(e,u.IS_MATCH)},p=function(e){return r(e,u.IS_CHECKED)},y=function(e){return r(e,u.PARENT_ID)},N=function(e){return r(l({},u.UUID,e),u.PARENT_ID)},_=function(e){var n;return"object"===D(e)?s(e):"string"==typeof e&&(null===(n=t(e))||void 0===n?void 0:n[u.IS_OPEN])},h=function(e){return e.split("-").reduce((function(e,t){var r=Number(t);return Array.isArray(e)?e[r]:e[n.children][r]}),n.data)},I=function(e){return h(i(l({},u.UUID,e)))},E=function(e){var n;return l(n={},v[u.IS_LOADING],r(e,u.IS_LOADING)),l(n,v[u.HAS_CHILD],d(e)),l(n,v[u.IS_MATCH],f(e)),l(n,v[u.IS_CHECKED],p(e)),l(n,v[u.IS_OPEN],s(e)),l(n,v[u.IS_ROOT],c(e)),l(n,"fullPath",r(e,u.PATH)),l(n,"uuid",a(e)),l(n,"parentId",r(e,u.PARENT_ID)),n};return{getSchemaVal:t,getNodeAttr:r,getNodeId:a,getNodeParentId:y,getNodeParentIdById:N,getParentNodeData:function(e){return c(l({},u.UUID,e))?l({},n.children,n.data):I(N(e))},getParentNode:function(e){return t(y(e))},setNodeAttr:o,getNodePath:i,isRootNode:c,isNodeOpened:s,hasChildNode:d,isItemOpen:_,isNodeChecked:p,isNodeMatched:f,isNodeLoading:function(e){return r(e,u.IS_LOADING)},checkNodeIsOpen:function(e){return c(e)||function(e){return _(r(e,u.PARENT_ID))}(e)},getSourceNodeByPath:h,getSourceNodeByUID:I,deleteNodeSchema:function(n){return e.schema.delete(n)},resolveScopedSlotParam:E,setTreeNodeLoading:function(e,n){o(e,u.IS_LOADING,n)},extendNodeAttr:function(e){return Object.assign(Object.assign({},e),l({},u.TREE_NODE_ATTR,E(e)))},getChildNodes:function(n){var t=e.schema;return Array.prototype.filter.call(Array.from(t.keys()),(function(e){return t.get(e)[u.PARENT_ID]===n[u.UUID]}))}}};function m(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function O(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return m(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?m(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var b=void 0,P="1px dashed #c3cdd7",L=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],a=e[n];return"boolean"==typeof a?a?r:o:U(t,e,n,i)},U=function(e,n,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=n[t];if("string"==typeof o)return"object"===D(e)&&null!==e?(Object.prototype.hasOwnProperty.call(e,o)||console.error("cannot find node label with key ".concat(o)),e[o]):o;if("function"==typeof o){var i=o.apply(b,[e].concat(O(r)));return"string"==typeof i?i:void console.error("props label with function return value is not string, please check and return string")}},x=function(e,n){return U(e,n,"label")},R=function(e,n){return e.get(n)||{}},k=function(e,n,t){var r;return null===(r=R(e,n))||void 0===r?void 0:r[t]},H=function(e,n){return{"--level-line":L(n,"levelLine",e,P,null,["tree"]),"--lineHeight":"".concat(n.lineHeight,"px"),"--indent":"".concat(n.indent,"px"),"--offset-left":"".concat(n.offsetLeft,"px")}},w=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.schema,o=k(r,e[u.UUID],u.DEPTH);return Object.assign({"--depth":o},"function"==typeof n.levelLine?{"--level-line":L(n,"levelLine",e,P,null,["node"])}:{})},j=function(e,n,t){var r=R(n,e[u.UUID])||{};return{"is-root":r.__is_root,"bk-tree-node":!0,"is-open":r.__is_open,"is-virtual-render":t.virtualRender,"level-line":t.levelLine}},V=function(e,n){var t=R(n,e[u.UUID])||{};return l({"is-checked":t.__is_checked,"is-selected":t.__is_selected,"node-folder":e.is_folder,"node-leaf":e.is_leaf},(0,r.resolveClassName)("node-row"),!0)},M=function(e){return null==e?{__IS_NULL:!0}:"string"==typeof e||"number"==typeof e||"symbol"===D(e)?l({},u.UUID,e):(Object.prototype.hasOwnProperty.call(e,u.UUID)||console.error("setNodeAction Error: node id cannot found"),e)};const K=function(e,n){var t=C(n,e),r=t.setNodeAttr,o=t.getNodePath,i=t.getNodeAttr,a=t.resolveScopedSlotParam,c=t.setTreeNodeLoading,s=function(n,t){if("object"===D(n)&&null!==n){r(t,u.IS_OPEN,!0);var i=Array.isArray(n)?n:[n];return function(e,n,t,r,o){!function(e,n,t,r){var o=e.split("-").reduce((function(e,n){var r=Number(n);return Array.isArray(e)?e[r]:e[t][r]}),n);Object.assign(o,r||{})}(e,n,t,l({},r,o))}(o(t),e.data,e.children,e.children,i),Promise.resolve(n)}return Promise.resolve(n)},d=function(n){var t=e.async||{},o=t.callback,l=void 0===o?null:o,d=t.cache,f=void 0===d||d;if("function"==typeof l&&i(n,u.IS_ASYNC)){if(r(n,u.IS_ASYNC_INIT,!0),!i(n,u.IS_CACHED)){r(n,u.IS_CACHED,f);var p=a(n),v=l(n,(function(e){return s(e,n)}),p);if("object"===D(v)&&null!==v)return c(n,!0),v instanceof Promise?Promise.resolve(v.then((function(e){return s(e,n)})).catch((function(e){return console.error("load remote data error:",e)})).finally((function(){c(n,!1),r(n,u.IS_CACHED,!0)}))):(s(v,n),c(n,!1),Promise.resolve(!0))}return Promise.resolve(!0)}return Promise.resolve(!0)};return{asyncNodeClick:d,deepAutoOpen:function e(){var t=n.data.filter((function(e){return i(e,u.IS_ASYNC)&&e[v[u.IS_OPEN]]&&!i(e,u.IS_ASYNC_INIT)}));t.length&&Promise.all(t.map((function(e){return d(e)}))).then((function(){e()})).catch((function(e){console.warn(e)}))}}},G=function(e,n,i,a,c,s){var d=e.selected,f=C(i,e),p=f.setNodeAttr,v=f.getNodePath,y=f.getSchemaVal,N=f.getNodeAttr,_=f.getNodeId,h=f.getChildNodes,I=f.isRootNode,E=f.hasChildNode,S=f.isItemOpen,g=f.isNodeOpened,m=f.isNodeLoading,O=f.isNodeChecked,b=f.getParentNode,P=f.resolveScopedSlotParam,L=f.extendNodeAttr,U=s.registerNextLoop,R=K(e,i),k=R.asyncNodeClick,H=R.deepAutoOpen,G=function(e){if("string"==typeof e)return e;if("object"===D(e)&&null!==e){if(e.__v_isVNode)return e;var n=e.node,t=e.className,r=e.text,i=e.style;return(0,o.h)(n,{class:t,style:i},r)}return null},q=function(t){if(n.slots.nodeAction)return n.slots.nodeAction(L(t));var i=null;return m(t)?function(e){var t,r,i;return(null!==(i=null===(r=(t=n.slots).nodeLoading)||void 0===r?void 0:r.call(t,L(e)))&&void 0!==i?i:m(e))?(0,o.createVNode)(A.Spinner,null,null):""}(t):"function"==typeof e.prefixIcon&&"default"!==(i=e.prefixIcon(L(t),"node_action"))?G(i):("default"===i||"boolean"==typeof e.prefixIcon&&e.prefixIcon)&&(E(t)||t.async||!e.autoCheckChildren)?S(t)?(0,o.createVNode)(A.DownShape,{class:(0,r.resolveClassName)("node-prefix")},null):(0,o.createVNode)(A.RightShape,{class:(0,r.resolveClassName)("node-prefix")},null):null},Y=function(t){if(!e.showNodeTypeIcon)return null;if(n.slots.nodeType)return n.slots.nodeType(L(t));var i=null;return"function"==typeof e.prefixIcon&&"default"!==(i=e.prefixIcon(L(t),"node_type"))?G(i):"default"===i||"boolean"==typeof e.prefixIcon&&e.prefixIcon?I(t)||E(t)?function(e){return S(e)?(0,o.createVNode)(A.FolderShapeOpen,{class:[(0,r.resolveClassName)("tree-icon"),(0,r.resolveClassName)("node-prefix")]},null):(0,o.createVNode)(A.Folder,{class:[(0,r.resolveClassName)("tree-icon"),(0,r.resolveClassName)("node-prefix")]},null)}(t):(0,o.createVNode)(A.TextFile,{class:[(0,r.resolveClassName)("tree-icon"),(0,r.resolveClassName)("node-prefix")]},null):null},F=function e(n,t){var r=b(n);r&&(p(r,u.IS_CHECKED,t),I(r)||e(r,t))},X=function e(n,t,r){h(n).forEach((function(n){p(l({},u.UUID,n),t,r),e(l({},u.UUID,n),t,r)}))},z=function(e,r){p(e,u.IS_CHECKED,!!r),X(e,u.IS_CHECKED,!!r),F(e,r),n.emit(t.NODE_CHECKED,c.value.filter((function(e){return O(e)})).map((function(e){return e[u.UUID]})))},J=function(e){return O(e)&&!c.value.filter((function(n){var t;return null===(t=v(n))||void 0===t?void 0:t.startsWith(v(e))})).every((function(e){return O(e)}))},B=function(e){return O(e)||c.value.filter((function(n){var t;return null===(t=v(n))||void 0===t?void 0:t.startsWith(v(e))})).some((function(e){return O(e)}))},W=function(n){return e.showCheckbox?(0,o.createVNode)(T(),{size:"small",modelValue:B(n),indeterminate:J(n),onChange:function(e){return z(n,e)}},null):null},Z=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=null===r?!S(e):!!r;if(a||X(e,u.IS_OPEN,a),p(e,u.IS_OPEN,a),i){var l=S(e)?t.NODE_EXPAND:t.NODE_COLLAPSE;n.emit(l,e,P(e),y(e[u.UUID]),o)}},$=function(e,n,t){Array.isArray(e)?e.forEach((function(e){return p(M(e),n,t)})):p(M(e),n,t)},Q=function e(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=M(n);if(!o[u.IS_NULL])if(r)if(t){if($(o,u.IS_OPEN,!0),!I(o)){var i=N(o,u.PARENT_ID);e(i,!0,!0)}}else Z(o,!1,null,!1);else $(o,u.IS_OPEN,t)},ee=function(e,n){g(e)?Z(e,!1,n):k(e).finally((function(){N(e,u.IS_LOADING)?U("setNodeOpenedAfterLoading",{type:"once",fn:function(){return Z(e,!0,n)}}):Z(e,!0,n)}))},ne=function n(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Array.isArray(t)?t:[t];if(a.length){var c=M(a[0]);c[u.IS_NULL]||(!e.selectable||"function"==typeof e.selectable&&!e.selectable(t)||e.disabledFolderSelectable&&!0===(null==t?void 0:t.is_folder)?console.warn("props.selectable is false or undefined, please set selectable with true"):(null!=d&&p(l({},u.UUID,d),u.IS_SELECTED,!r),e.selected&&e.selected!==d&&p(l({},u.UUID,e.selected),u.IS_SELECTED,!r),p(c,u.IS_SELECTED,r),d=_(c),i&&1===a.length&&Q(c,!0,!0),N(c,u.IS_ASYNC)&&k(c).then((function(){(0,o.nextTick)((function(){a.shift(),n(a,r,i)}))}))))}},te=function(n){if(!e.levelLine)return null;var t=N(n,u.DEPTH)+1;return new Array(t).fill("").map((function(e,n){return n})).filter((function(e){return function(e,n){if(I(n))return!1;var t=v(n),r="".concat(t).split("-").slice(0,e+1);if(r.join("-")===t)return!0;var o=r.pop(),i=parseInt(o,10);r.push("".concat(i+1));var a=r.join("-");return c.value.some((function(e){return e[u.PATH]===a}))}(e,n)})).filter((function(e){return e>0})).map((function(e){return(0,o.createVNode)("span",{class:"node-virtual-line",style:(n=t-e,{"--depth":n})},null);var n}))};return{renderTreeNode:function(a){var l,c,s,d,f;return(0,o.createVNode)("div",{"data-tree-node":_(a),key:_(a),class:V(a,i.schema)},[(0,o.createVNode)("div",{class:j(a,i.schema,e),style:w(a,e,i),onClick:function(r){return function(r,o){var i,a=(i=r,"function"==typeof e.nodeContentAction?Reflect.apply(e.nodeContentAction,void 0,[{node:i}]):"string"==typeof e.nodeContentAction?[e.nodeContentAction]:Array.isArray(e.nodeContentAction)?e.nodeContentAction:["selected","expand","click"]);if(a.includes("selected")&&ne(r,!0,!1),a.includes("expand")&&(g(r)||ee(r,o)),a.includes("collapse")&&g(r)&&ee(r,o),a.includes("click")){var l=t.NODE_CLICK;n.emit(l,r,P(r),y(r[u.UUID]),o)}}(a,r)}},[(0,o.createVNode)("div",{class:[(0,r.resolveClassName)("node-action")],onClick:function(e){return function(e,n){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),ee(n,e)}(e,a)}},[q(a)]),(0,o.createVNode)("div",{class:(0,r.resolveClassName)("node-content")},[[W(a),Y(a)],(0,o.createVNode)("span",{class:(0,r.resolveClassName)("node-text")},[null!==(s=null===(c=(l=n.slots).node)||void 0===c?void 0:c.call(l,L(a)))&&void 0!==s?s:[x(a,e)]]),null===(f=(d=n.slots).nodeAppend)||void 0===f?void 0:f.call(d,L(a))]),te(a)])])},handleTreeNodeClick:ee,deepAutoOpen:H,asyncNodeClick:k,setNodeAction:$,setNodeOpened:Z,setSelect:ne,setOpen:Q}};var q=c(8022),Y=void 0;const F=(0,o.defineComponent)({name:"Tree",props:I,emits:f,setup:function(e,n){var i=function(e){var n,t=function(e){var n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=e.data,i=e.children,a=[],c=[],s=0,d=new Map;function f(e,n,t,r){if(null!=e&&d.has(e)&&![u.UUID,u.PARENT_ID].includes(n)){var o=d.get(e);Object.prototype.hasOwnProperty.call(o,n)&&"function"==typeof r&&Reflect.apply(r,self,[o,n,t])&&(Object.assign(o,l({},n,t)),f(o[u.PARENT_ID],n,t,r))}}function p(n){var t=null;return"string"==typeof e.nodeKey&&(t=n[e.nodeKey]||(0,q.v4)()),t||n[u.UUID]||(0,q.v4)()}var y=(l(n={},u.IS_OPEN,(function(){return!!e.expandAll})),l(n,u.IS_CHECKED,(function(){return!1})),l(n,u.IS_MATCH,(function(){return!0})),l(n,u.IS_SELECTED,(function(n){return e.selected===n})),l(n,u.IS_CACHED,(function(){return!1})),l(n,u.IS_ASYNC,(function(){return null})),l(n,u.IS_LOADING,(function(){return!1})),n);function N(e,n,t){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=o;void 0===o&&"function"==typeof y[t]&&(i=y[t](e,n));var a=v[t];if(Object.prototype.hasOwnProperty.call(n,a))return n[a];var l=(r||[]).find((function(n){return n[u.UUID]===e})),c=void 0;return l&&(c=l[t]),null==c&&(c=i),c}function _(n,t){return!!e.selectable&&N(n,t,u.IS_SELECTED,e.selected===n)}function h(e,n,t){var r,o=N(e,n,u.IS_OPEN),i=!d.has(t)||(null===(r=d.get(t))||void 0===r?void 0:r[u.IS_OPEN]);return o&&i}function I(e){return!e[u.IS_OPEN]}function E(n){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,v=n.length,y=0;y<v;y++){var S=n[y];if(Array.isArray(S))E(S,t,r,o);else if("object"===D(S)&&null!==S){var g,T,A=null!==o?"".concat(o,"-").concat(y):"".concat(y),C="".concat(p(S)),m=!!(S[i]||[]).length,O=N(C,S,u.IS_OPEN);e.autoOpenParentNode?O&&f(r,u.IS_OPEN,!0,I):O=h(C,S,r),Object.assign(S,l({},u.UUID,C));var b=e.showCheckbox&&N(C,S,u.IS_CHECKED);b&&a.push(C),d.set(C,(l(g={},u.DEPTH,t),l(g,u.INDEX,y),l(g,u.UUID,C),l(g,u.PARENT_ID,r),l(g,u.HAS_CHILD,m),l(g,u.PATH,A),l(g,u.IS_ROOT,null===r),l(g,u.ORDER,s),l(g,u.IS_SELECTED,_(C,S)),l(g,u.IS_MATCH,N(C,S,u.IS_MATCH)),l(g,u.IS_OPEN,O),l(g,u.IS_CHECKED,b),l(g,u.IS_CACHED,N(C,S,u.IS_CACHED)),l(g,u.IS_ASYNC,N(C,S,u.IS_ASYNC)),l(g,u.IS_LOADING,N(C,S,u.IS_LOADING)),l(g,i,null),g)),s+=1,c.push(Object.assign(Object.assign({},JSON.parse(JSON.stringify(S,(function(n,t){return n===e.children?null:t})))),(l(T={},u.IS_OPEN,O),l(T,i,null),T))),Object.prototype.hasOwnProperty.call(S,i)&&E(S[i]||[],t+1,C,A)}}}return E(t||o),e.showCheckbox&&(null==a||a.forEach((function(e){Array.from(d.values()).filter((function(n){var t;return null===(t=n[u.PATH])||void 0===t?void 0:t.startsWith(d.get(e)[u.PATH])})).forEach((function(e){return Object.assign(e,l({},u.IS_CHECKED,!0))})),f(e,u.IS_CHECKED,!0,(function(){return!0}))}))),[c,d]},r=t(e),i=new Map,a=[],c=[],s=(0,o.reactive)({data:r[0],schema:r[1],levelLineSchema:{}}),d=(0,o.computed)((function(){return Array.from(s.schema.values())})),f=K(e,s),p=f.asyncNodeClick,y=f.deepAutoOpen,N=function(e,n){(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&i.has(e)&&i.delete(e),i.set(e,n)},_=function(e){var n,t=function(e){return"function"==typeof e?{type:"loop",fn:e}:"object"===D(e)&&"string"==typeof e.type&&"function"==typeof e.fn?e:(console.error("loop event error",e),null)}(e);return null!==t&&Reflect.apply(t.fn,Y,[]),null!==(n=null==t?void 0:t.type)&&void 0!==n?n:"once"};return(0,o.watch)((function(){return[e.data]}),(function(n){var r,o,a=t(e,n,d.value);s.data=a[0],s.schema=a[1],(null===(r=e.async)||void 0===r?void 0:r.callback)&&"every"===(null===(o=e.async)||void 0===o?void 0:o.deepAutoOpen)&&y(),Array.from(i.keys()).forEach((function(e){var n=i.get(e);if(Array.isArray(n)){var t=[];n.forEach((function(e,n){"once"===_(e)&&t.unshift(n)})),t.length&&t.forEach((function(e){return n.splice(e,1)})),0===n.length&&i.delete(e)}else"once"===_(n)&&i.delete(e)}))}),{deep:!0}),e.selectable&&(0,o.onMounted)((function(){(0,o.watch)((function(){return e.selected}),(function(e){c.length=0,a.forEach((function(n){Reflect.apply(n,Y,[e]),c.push((function(){return Reflect.apply(n,Y,[e])}))})),N("afterSelectWatch",c)}),{immediate:!0})})),(null===(n=e.async)||void 0===n?void 0:n.callback)&&y(),{flatData:s,schemaValues:d,asyncNodeClick:p,deepAutoOpen:y,afterDataUpdate:function(e){N("afterDataUpdate",e)},registerNextLoop:N,onSelected:function(e){a.push(e)}}}(e),c=i.flatData,s=i.schemaValues,d=i.onSelected,f=i.registerNextLoop,p=C(c,e),y=p.setNodeAttr,N=p.checkNodeIsOpen,_=p.getNodeAttr,h=p.getNodePath,I=p.isRootNode,E=p.isNodeOpened,g=p.isNodeChecked,T=p.isNodeMatched,A=p.hasChildNode,m=function(e){var n,t=(0,o.toRef)(e,"search"),r=null!==(n=e.search)&&void 0!==n?n:{},i=r.openResultNode,a=void 0!==i&&i,l=r.resultType,u=void 0===l?"tree":l,c=function(e){return["string","number","boolean"].includes(D(e))},s=function(e,n){return e===n},d=function(e,n){return new RegExp("".concat(e),"i").test("".concat(n))},f=function(e,n){return Reflect.apply(e,void 0,n)},p=void 0===t.value||!1===t.value,v=(0,o.computed)((function(){return!1!==t.value&&(c(t.value)?"".concat(t.value).length>0:"object"===D(t.value))}));return{searchFn:function(e,n){if(p)return!0;if(c(t.value))return f(d,[t.value,e,n]);var r=t.value,o=r.value,i=void 0===o?"":o,a=r.match,l=void 0===a?"fuzzy":a,u="function"==typeof l?l:"fuzzy"===l?d:s;return 0==="".concat(i).length||f(u,[i,e,n])},refSearch:t,isSearchActive:v,isSearchDisabled:p,openResultNode:a,resultType:u,isTreeUI:"tree"===u}}(e),O=m.searchFn,b=m.isSearchActive,P=m.refSearch,L=m.openResultNode,U=m.isTreeUI;m.isSearchDisabled||(0,o.watch)([P],(function(){c.data.forEach((function(n){var t=O(x(n,e),n);y(n,u.IS_MATCH,t),L&&F(n,!0,!0)}))}));var R=(0,o.computed)((function(){return c.data.filter((function(e){return N(e)&&function(e){return!b.value||(_(e,u.IS_MATCH)||!!U&&s.value.some((function(n){var t;return(null===(t=n[u.PATH])||void 0===t?void 0:t.startsWith(h(e)))&&n[u.IS_MATCH]})))}(e)}))})),k=G(e,n,c,0,s,{registerNextLoop:f}),w=k.renderTreeNode,j=k.handleTreeNodeClick,V=k.setNodeOpened,F=k.setOpen,X=k.setNodeAction,z=k.setSelect,J=k.asyncNodeClick;d((function(n){z(n,!0,e.autoOpenParentNode)})),n.expose({handleTreeNodeClick:j,isNodeChecked:g,isRootNode:I,isNodeOpened:E,isNodeMatched:T,hasChildNode:A,setOpen:F,setChecked:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X(M(e),u.IS_CHECKED,n)},setNodeAction:X,setNodeOpened:V,setSelect:z,asyncNodeClick:J,getData:function(){return c}});var B=(0,o.ref)(),W=function(e,n){var t=n.slots;return{renderEmpty:function(n){var r,i;return(0,o.createVNode)(S(),{scene:"part",type:n},{default:function(){return[null!==(i=null===(r=t.default)||void 0===r?void 0:r.call(t))&&void 0!==i?i:e.emptyText]}})}}}(e,n),Z=W.renderEmpty;return function(e,n,r,i){var a=C(i,e),c=a.getSourceNodeByUID,s=a.getNodeParentIdById,d=a.getParentNodeData,f=a.getNodeAttr,p=a.getNodePath,v=a.isRootNode,y=(0,o.computed)((function(){return"function"==typeof e.disableDrag})),N=(0,o.computed)((function(){return"function"==typeof e.disableDrop})),_=function(e){return e.target.closest("[data-tree-node]")},h=function(e){var n,t=null===(n=null==e?void 0:e.dataset)||void 0===n?void 0:n.treeNode;return c(t)},I=function e(n){_(n).removeEventListener("mouseup",e)},E=function(n){var t=_(n),r=h(t);!1===r.draggable||y.value&&e.disableDrag(r)?t.classList.add("bk-tree-drag-disabled"):(t.setAttribute("draggable","true"),t.addEventListener("mouseup",I))},S=function(r){r.preventDefault();var o=_(r),i=h(o);if(n.emit(t.NODE_DRAG_OVER,r,o,i),N.value&&(null==e?void 0:e.disableDrop(i)))return r.dataTransfer.effectAllowed="move",r.dataTransfer.dropEffect="none",void o.classList.add("bk-tree-drop-disabled");o.classList.add("bk-tree-drop-active");var a=r.dataTransfer.getData("node-id"),l=o.getAttribute("data-tree-node"),u=T(a,l)?"move":"none";r.dataTransfer.effectAllowed=u,r.dataTransfer.dropEffect=u},D=function(e){e.dataTransfer.effectAllowed="move",e.dataTransfer.dropEffect="move";var r=_(e);e.dataTransfer.setData("text/plain",""),e.dataTransfer.setData("node-id",r.getAttribute("data-tree-node")),n.emit(t.NODE_DRAG_START,e,r)},g=function(r){r.preventDefault(),r.stopPropagation();var o=_(r);o.classList.remove("bk-tree-drop-active","bk-tree-drop-disabled");var i=h(o);if(!N.value||!e.disableDrop(i)){var a=r.dataTransfer.getData("node-id"),l=o.getAttribute("data-tree-node");Reflect.apply(e.dragSort?A:m,void 0,[a,l]),n.emit(t.NODE_DROP,r,o,i)}},T=function(e,n){var t=p(l({},u.UUID,e)),r=p(l({},u.UUID,n));return s(e)===s(n)||-1===t.indexOf(r)&&-1===r.indexOf(t)},A=function(n,t){if(T(n,t)){var r=JSON.parse(JSON.stringify(c(n))),o=JSON.parse(JSON.stringify(c(t))),i=d(n),a=d(t),s=f(l({},u.UUID,n),u.INDEX),p=f(l({},u.UUID,t),u.INDEX);null==i||i[e.children].splice(s,1,o),null==a||a[e.children].splice(p,1,r)}},m=function(n,t){var r=c(n),o=c(t),i=null;if(v(l({},u.UUID,n)))i=e.data;else{var a=s(n);if(null!=a){i=c(a);var d=f(l({},u.UUID,n),u.INDEX);null==i||i[e.children].splice(d,1)}}o[e.children]||(o[e.children]=[]),o[e.children].unshift(r)},O=function(e){e.preventDefault();var r=_(e);r.classList.remove("bk-tree-drop-active","bk-tree-drop-disabled"),n.emit(t.NODE_DRAG_LEAVE,e,r)};(0,o.onMounted)((function(){if(e.draggable&&r.value){var n=r.value.$el;n.addEventListener("mousedown",E),n.addEventListener("dragstart",D),n.addEventListener("dragover",S),n.addEventListener("dragleave",O),n.addEventListener("drop",g)}})),(0,o.onUnmounted)((function(){if(e.draggable&&r.value){var n=r.value.$el;n.removeEventListener("mousedown",E),n.removeEventListener("dragstart",D),n.removeEventListener("dragover",S),n.removeEventListener("dragleave",O),n.removeEventListener("drop",g)}}))}(e,n,B,c),function(){return(0,o.createVNode)(a(),{class:(0,r.resolveClassName)("tree"),style:H(null,e),list:R.value,lineHeight:e.lineHeight,enabled:e.virtualRender,contentClassName:(0,r.resolveClassName)("container"),throttleDelay:0,ref:B},{default:function(e){return function(e){var t,r,o;if(e.length)return e.map(w);var i=b.value?"search-empty":"empty";return null!==(o=null===(r=(t=n.slots).empty)||void 0===r?void 0:r.call(t))&&void 0!==o?o:Z(i)}(e.data||[])}})}}}),X=(0,r.withInstall)(F)})(),s})()));