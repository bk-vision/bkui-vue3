!function(e,r){if("object"==typeof exports&&"object"==typeof module)module.exports=r(require("../shared"),require("vue"),require("lodash"),require("../config-provider"),require("../directives"),require("../icon"));else if("function"==typeof define&&define.amd)define(["../shared","vue","lodash","../config-provider","../directives","../icon"],r);else{var t="object"==typeof exports?r(require("../shared"),require("vue"),require("lodash"),require("../config-provider"),require("../directives"),require("../icon")):r(e["../shared"],e.vue,e.lodash,e["../config-provider"],e["../directives"],e["../icon"]);for(var o in t)("object"==typeof exports?exports:e)[o]=t[o]}}(self,((e,r,t,o,n,i)=>(()=>{"use strict";var s={2717:e=>{e.exports=o},4061:e=>{e.exports=n},6870:e=>{e.exports=i},4212:r=>{r.exports=e},467:e=>{e.exports=t},748:e=>{e.exports=r}},a={};function l(e){var r=a[e];if(void 0!==r)return r.exports;var t=a[e]={exports:{}};return s[e](t,t.exports,l),t.exports}l.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return l.d(r,{a:r}),r},l.d=(e,r)=>{for(var t in r)l.o(r,t)&&!l.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},l.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var u={};return(()=>{l.r(u),l.d(u,{BkComposeFormItem:()=>o,BkForm:()=>P,BkFormItem:()=>x,default:()=>j});var e=l(4212),r=l(748),t=function(e){return e.__v_isVNode};const o=(0,r.defineComponent)({name:"ComposeFormItem",props:{headBackgroundColor:{type:String,default:"#FAFBFD"},tailBackgroundColor:String},render:function(){if(!this.$slots.default)return null;var e=this.$slots.default();if(e.length>1){for(var o=e.length,n=0,i=null;n<o;){if(t(e[n])){i=e[n];break}n+=1}for(var s=o-1,a=null;s>=0&&s>n;){if(t(e[s])){a=e[s];break}s-=1}if(i&&a){i.props||(i.props={});var l="bk-compose-form-item-head";i.props.class&&(l+=" ".concat(i.props.class)),this.headBackgroundColor&&(i.props.style=Object.assign(i.props.style||{},{"background-color":this.headBackgroundColor})),i.props.class=l,a.props||(a.props={});var u="bk-compose-form-item-tail";a.props.class&&(u+=" ".concat(a.props.class)),this.tailBackgroundColor&&(a.props.style=Object.assign(a.props.style||{},{"background-color":this.tailBackgroundColor})),a.props.class=u}}return(0,r.h)("div",{class:"bk-compose-form-item"},e)}});function n(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var i={formType:e.PropTypes.oneOf(["default","vertical"]).def("default"),labelWidth:e.PropTypes.oneOfType([Number,String]).def(150),labelPosition:e.PropTypes.oneOf(["left","center","right"]),model:e.PropTypes.object,rules:e.PropTypes.object};const s=(0,r.defineComponent)({name:"Form",props:i,emits:["submit"],setup:function(t,o){var i=[];return(0,r.provide)(e.formKey,{props:t,register:function(e){i.push(e)},unregister:function(e){i=i.reduce((function(r,t){return t!==e&&r.push(t),r}),[])}}),{handleSubmit:function(e){e.preventDefault(),o.emit("submit")},validate:function(e){var r={};return r=e?("string"==typeof e?[e]:e).reduce((function(e,r){return Object.assign(Object.assign({},e),n({},r,!0))}),{}):i.reduce((function(e,r){return r.property?Object.assign(Object.assign({},e),n({},r.property,!0)):e}),{}),Promise.all(i.reduce((function(e,t){return r[t.property]&&e.push(t.validate()),e}),[])).then((function(){return Promise.resolve(t.model)}))},clearValidate:function(e){var r={};r=e?("string"==typeof e?[e]:e).reduce((function(e,r){return Object.assign(Object.assign({},e),n({},r,!0))}),{}):i.reduce((function(e,r){return Object.assign(Object.assign({},e),n({},r.property,!0))}),{}),i.forEach((function(e){return r[e.property]&&e.clearValidate()}))}}},render:function(){var t,o,i=(0,e.classes)(n({"bk-form":!0},"bk-form--".concat(this.formType),!0));return(0,r.createVNode)("form",{class:i,onSubmit:this.handleSubmit},[null===(o=(t=this.$slots).default)||void 0===o?void 0:o.call(t)])}});function a(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,o=new Array(r);t<r;t++)o[t]=e[t];return o}function c(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(e){if("string"==typeof e)return a(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?a(e,r):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var p=l(467),f=l.n(p),d=l(2717),m=l(4061),g=l(6870),b=function(e){return"function"==typeof e.message?e.message():e.message};const v={required:function(e){return!("number"!=typeof e&&"boolean"!=typeof e&&!f().isDate(e)&&f().isEmpty(e))},min:function(e,r){return e>=r},max:function(e,r){return r>=e},email:function(e){return/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/.test(e)},maxlength:function(e,r){return e.length<=r},pattern:function(e,r){return r.test(e)}};var y={label:e.PropTypes.string,labelWidth:e.PropTypes.oneOfType([Number,String]),labelPosition:e.PropTypes.oneOf(["left","center","right"]),property:e.PropTypes.string.def(""),required:e.PropTypes.bool.def(!1),email:e.PropTypes.bool.def(!1),max:e.PropTypes.number,min:e.PropTypes.number,maxlength:e.PropTypes.number,rules:e.PropTypes.array,autoCheck:e.PropTypes.bool.def(!1),description:e.PropTypes.string,errorDisplayType:e.PropTypes.oneOf(["tooltips","normal"]).def("normal")},h=function(e){return void 0!==e};const x=(0,r.defineComponent)({name:"FormItem",directives:{bkTooltips:m.bkTooltips},props:y,setup:function(t,o){var i=(0,d.useLocale)("form"),s=(0,e.useForm)(),a=Boolean(s),l=(0,e.useFormItem)(),u=Boolean(l),f=(0,r.getCurrentInstance)(),m=(0,r.reactive)({isError:!1,errorMessage:""}),g=(0,r.computed)((function(){return!!a&&"vertical"===s.props.formType})),y=(0,r.computed)((function(){return!(!t.label&&!o.slots.label)})),x=(0,r.computed)((function(){var e={width:"",paddingRight:"",textAlign:""},r=t.labelPosition||a&&s.props.labelPosition;if(r&&(e["text-align"]=r),"vertical"===s.props.formType||!t.label&&u)return e;var o=h(t.labelWidth)?t.labelWidth:a&&s.props.labelWidth;return h(o)&&(e.width="".concat(o,"px"),e.paddingRight=o?"":"0px"),e})),P=(0,r.computed)((function(){return n({},"margin-left",x.value.width)})),j=function(e){if(!t.property||a&&!s.props.model)return Promise.resolve(!0);var r,o,n=[];a&&s.props.rules&&(r=s.props.rules,o=t.property,Object.prototype.hasOwnProperty.call(r,o))&&(n=s.props.rules[t.property]),t.rules&&(n=t.rules),n=function(e,r){return r.reduce((function(r,t){return t.trigger&&e?((Array.isArray(t.trigger)?t.trigger:[t.trigger]).includes(e)&&r.push(t),r):(r.push(t),r)}),[])}(e,function(e,r,t){var o=!1,n=!1,i=e.reduce((function(e,r){var i;if(r.required)i=(0,p.isFunction)(r.validator)?r.validator:v.required,o=!0;else if(r.email)i=(0,p.isFunction)(r.validator)?r.validator:v.email,n=!0;else if(Number(r.max)>-1)i=function(e){return v.max(e,r.max)};else if(Number(r.min)>-1)i=function(e){return v.min(e,r.max)};else if(Number(r.maxlength)>-1)i=function(e){return v.min(e,r.max)};else if("[object RegExp]"===Object.prototype.toString.call(r.pattern))i=function(e){return v.pattern(e,r.pattern)};else{if(!(0,p.isFunction)(r.validator))return e;i=r.validator}return e.push({validator:i,message:r.message||t.value.verifyError,trigger:r.trigger||"blur"}),e}),[]),s=r.reduce((function(e,r){return r.required&&o||r.email&&n||e.push(r),e}),[]);return[].concat(c(s),c(i))}(n,function(e,r){var t=[],o=e.label||"";return e.required&&t.push({required:!0,validator:v.required,message:"".concat(o," ").concat(r.value.notBeEmpty),trigger:"change"}),e.email&&t.push({email:!0,validator:v.email,message:"".concat(o," ").concat(r.value.incorrectFormat),trigger:"change"}),Number(e.max)>-1&&t.push({validator:function(r){return v.max(r,e.max)},message:"".concat(o," ").concat(r.value.max," ").concat(e.max),trigger:"change"}),Number(e.min)>-1&&t.push({validator:function(r){return v.min(r,e.min)},message:"".concat(o," ").concat(r.value.min," ").concat(e.min),trigger:"change"}),Number(e.maxlength)>-1&&t.push({validator:function(r){return v.maxlength(r,e.maxlength)},message:"".concat(o," ").concat(r.value.maxLen," ").concat(e.maxlength),trigger:"change"}),t}(t,i),i)),n.length>0&&(m.isError=!1,m.errorMessage="");var l,u=(0,p.get)(s.props.model,t.property),f=(l=-1,function(){if((l+=1)>=n.length)return Promise.resolve(!0);var e=n[l];return Promise.resolve().then((function(){var r=e.validator(u);return"boolean"!=typeof r&&"function"==typeof r.then?r.then((function(r){if(!1===r)return Promise.reject(b(e))})).then((function(){return f()}),(function(){return m.isError=!0,m.errorMessage=b(e),Promise.reject(m.errorMessage)})):r?f():(m.isError=!0,m.errorMessage="string"==typeof r?r:b(e),Promise.reject(m.errorMessage))}))});return f()},T=function(){m.isError=!1,m.errorMessage=""};return(0,r.provide)(e.formItemKey,Object.assign(Object.assign({},t),{validate:j,clearValidate:T})),(0,r.onMounted)((function(){a&&s.register(f.proxy)})),(0,r.onBeforeUnmount)((function(){a&&s.unregister(f.proxy)})),Object.assign(Object.assign({},(0,r.toRefs)(m)),{isShowLabel:y,labelStyles:x,contentStyles:P,isFormTypeVertical:g,validate:j,clearValidate:T})},render:function(){var t,o,n,i,s=this,a=(0,e.classes)({"bk-form-item":!0,"is-error":this.isError,"is-required":this.required});return(0,r.createVNode)("div",{class:a},[this.isShowLabel&&(0,r.createVNode)("div",{class:"bk-form-label",style:this.labelStyles},[s.$slots.label?s.$slots.label():s.description?(0,r.withDirectives)((0,r.createVNode)("span",{class:{"bk-form-label-description":Boolean(s.description)}},[s.label]),[[(0,r.resolveDirective)("bk-tooltips"),s.description]]):s.label,this.isFormTypeVertical&&(null===(o=(t=this.$slots).labelAppend)||void 0===o?void 0:o.call(t))]),(0,r.createVNode)("div",{class:"bk-form-content",style:this.contentStyles},[null===(i=(n=this.$slots).default)||void 0===i?void 0:i.call(n),s.isError?"tooltips"===s.errorDisplayType?(0,r.withDirectives)((0,r.createVNode)("div",{class:"bk-form-error-tips"},[(0,r.createVNode)(g.ExclamationCircleShape,null,null)]),[[(0,r.resolveDirective)("bk-tooltips"),s.errorMessage]]):(0,r.createVNode)("div",{class:"bk-form-error"},[s.$slots.error?s.$slots.error(s.errorMessage):s.errorMessage]):null])])}});var P=(0,e.withInstallProps)(s,{FormItem:x,ComposeFormItem:o});const j=P})(),u})()));